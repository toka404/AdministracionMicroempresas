<div class="container-xxl hero-header" style="padding-bottom:0px">
    <div class="container">



        <div class="container">
            <div class="row">
                <form asp-action="Index" method="get">
                    <h5>Fecha Inicio</h5>
                    <input type="date" name="fechaInicio" class="form-control mar2 " />

                    <h5>Fecha Fin</h5>
                    <input type="date" name="fechaFin" class="form-control mar2 " />

                    <br />
                    <input type="submit" value="Consultar" class="btn btn-dark" />
                </form>
            </div>
        </div>

        @if (ViewData["fechaInicio"] != null)
        {
            <h2>Mostrando resultados desde @ViewData["fechaInicio"] hasta @ViewData["fechaFin"] </h2>
            <div>
                <div class="row">

                    <div class="col sm-6" style="visibility:hidden" id="PieProductosDesc">
                        <div class="card">
                            <div class="card-header">
                                Productos más vendidos
                            </div>
                            <div class="card-body">
                                <canvas class="my-4 h-25" id="bar"></canvas>
                            </div>
                        </div>
                    </div>

                    <div class="col sm-6" style="visibility:hidden" id="PieProductos">
                        <div class="card">
                            <div class="card-header">
                                Productos menos vendidos
                            </div>
                            <div class="card-body">
                                <canvas class="my-4 h-15" id="pie"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        }

    </div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.7.1/chart.min.js" integrity="sha512-QSkVNOCYLtj73J4hbmVoOV6KVZuMluZlioC+trLpewV8qMjsWqlIQvkn1KGX2StWvPMdWGBqim1xlC8krl1EKQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script type="text/javascript">

    var nombres = @Html.Raw(Json.Serialize(ViewBag.nombres));
    var cantidades = @Html.Raw(Json.Serialize(ViewBag.cantidades));
    var nombresDesc = @Html.Raw(Json.Serialize(ViewBag.nombresDesc));
    var cantidadesDesc = @Html.Raw(Json.Serialize(ViewBag.cantidadesDesc));

    console.log(nombres);
    console.log(cantidades);
    console.log(nombresDesc);
    console.log(nombresDesc.length);
    console.log(nombresDesc.length>0);

    if(nombresDesc.length>0){
        var barchart = document.getElementById('bar').getContext('2d');
        var mybarchart = new Chart(barchart, {
            type: 'pie',
            data: {
                labels: nombresDesc,
                datasets: [{
                    label: 'Producto',
                    data: cantidadesDesc,
                    backgroundColor: ['rgba(60,50,20)','rgba(146,78,39)','rgba(52,58,64)','rgba(203,167,129)','rgba(132,113,135)']
                }]
            },
            options:{
                scales: {
                    y: {
                        ticks: {
                            beginAtZero: true
                        }
                    }
                },
            }
        });
        var node = document.getElementById('PieProductosDesc');
            node.style.visibility = 'visible';
    }

    if(nombres.length>0){
        var piechart = document.getElementById('pie').getContext('2d');
        var mypiechart = new Chart(piechart, {
            type: 'pie',
            data: {
                labels: nombres,
                datasets: [{
                    label: 'Bar Chart',
                    data: cantidades,
                    backgroundColor: ['rgba(60,50,20)','rgba(146,78,39)','rgba(52,58,64)','rgba(203,167,129)','rgba(132,113,135)']
                }]
            },
            options:{
                scales: {
                    yAxes: [{
                        ticks: {
                            beginAtZero: true
                        }
                    }]
                }
            }
        });
        var node = document.getElementById('PieProductos');
        node.style.visibility = 'visible';
    }
</script>