@using X.PagedList;
@using X.PagedList.Mvc.Core
@using X.PagedList.Web.Common


@model IPagedList<Banding.Core.Models.ViewModels.FacturaViewModel>

@{
    Layout = "_Layout";


}
<div class="container-xxl hero-header" style="padding-bottom:0px">
    <div class="container">

        @if (!(Model.Count() > 0))
        {
            <div>No tiene ninguna factura</div>
            <a class="btn btn-dark btn-footer" asp-action="Create">Registrar Factura</a>
        }
        else
        {
            @foreach (var item in Model)
            {

                <div class="factura-label">
                    <div class="factura-header">
                        <div class="container-header">
                            <div class="container">
                                <h2>Factura N° @Html.DisplayFor(model => model.First().CabeceraFactura.NroFactura)</h2>


                                <div class="row">
                                    <div class="col-8">

                                        <div class="container">
                                            <div class="row">
                                                <div class="col-2">
                                                    <label><strong>Nombre</strong></label>
                                                    <label><strong>Cédula</strong></label>
                                                    <label><strong>Celular</strong></label>
                                                </div>
                                                <div class="col-5">
                                                    <label>
                                                        @Html.DisplayFor(model => model.First().CabeceraFactura.NombreCliente)
                                                    </label>
                                                    <label>
                                                        @Html.DisplayFor(model => model.First().CabeceraFactura.CedulaCliente)
                                                    </label>
                                                    <label>
                                                        @Html.DisplayFor(model => model.First().CabeceraFactura.TelefonoCliente)
                                                    </label>
                                                </div>
                                                <div class="col"></div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="col-4 align-content-end" style="padding:0">
                                        <div class="container">
                                            <div class="row">
                                                <div class="col-4">
                                                    <label><strong>Fecha</strong></label>
                                                    <label><strong>Dirección</strong></label>
                                                </div>
                                                <div class="col-7">

                                                    <label>
                                                        @Html.DisplayFor(model => model.First().CabeceraFactura.FechaCabecera)
                                                    </label>
                                                    <label>
                                                        @Html.DisplayFor(model => model.First().CabeceraFactura.DireccionCliente)
                                                    </label>
                                                </div>
                                                <div class="col">
                                                </div>
                                            </div>

                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <table class="table table-footer">
                        <thead>
                            <tr>
                                <th scope="col">Producto</th>
                                <th scope="col">Cantidad</th>
                                <th scope="col">Precio Unitario</th>
                                <th scope="col">Precio Total</th>
                            </tr>
                        </thead>

                        <tbody>

                            @foreach (var producto in item.DetalleFactura)
                            {
                                <tr>
                                    <td>@producto.NombreProducto</td>
                                    <td>@producto.CantidadVendida</td>
                                    <td>$@producto.PrecioUnitario</td>
                                    <td>$@producto.PrecioTotal</td>
                                </tr>
                            }

                        </tbody>
                    </table>

                    <div hidden>@Html.DisplayFor(model => model.First().CabeceraFactura.IdIva)</div>
                    <div hidden>@Html.DisplayFor(model => model.First().CabeceraFactura.IvaCero)</div>

                    <div class="container-header">
                        <div class="factura-footer">
                            <div class="container">
                                <div class="row">
                                    <div class="col-2">
                                        <label><strong>Subtotal</strong></label>
                                        <label><strong>Iva @item.Iva%</strong></label>
                                        <label><strong>Precio Total</strong></label>
                                    </div>
                                    <div class="col-1">
                                        <label>
                                            @Html.DisplayFor(model => model.First().CabeceraFactura.Subtotal)
                                        </label>
                                        <label>
                                            @Html.DisplayFor(model => model.First().CabeceraFactura.IvaTotal)
                                        </label>
                                        <label>
                                            @Html.DisplayFor(model => model.First().CabeceraFactura.Total)
                                        </label>
                                    </div>
                                    <div class="col">
                                    </div>
                                </div>
                            </div>

                            <div class="row">
                                <form asp-action="Delete" method="post">
                                    @{
                                        int IdCabecera = item.CabeceraFactura.IdCabecera;
                                    }
                                    <input type="hidden" asp-for="@IdCabecera" />

                                    <input type="submit" value="Anular" class="btn btn-dark btn-footer" />
                                </form>
                                <br>
                                <a class="btn btn-dark btn-footer" asp-action="Create">Registrar Factura</a>
                            </div>

                            @Html.PagedListPager((IPagedList)Model, page =>
                            Url.Action("Index", new { page = page }),
                            new PagedListRenderOptions {
                            LiElementClasses = new string[] { "page-item" },
                            PageClasses = new string[] { "page-link" }})
                        </div>
                    </div>


                </div>
            }
        }

    </div>
</div>
